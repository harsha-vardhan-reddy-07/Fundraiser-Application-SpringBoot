<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <link rel="stylesheet" href="/users/new-fundrisers.css">

    <title>Fundraiser!!</title>
</head>
<body>


<div class="navbar">
    <h3 > <a href="/" >SB Funds</a></h3>
    <div class="nav-options">
        <a href="/"  >Home</a>
        <a href="/my-fundrisers"  id="navMyApplication" >My fundraisers</a>
        <a href="/new-fundriser" >New fundraiser</a>
        <p id="logoutBtn" >logout</p>
    </div>
</div>

<script>

    const myLink = document.getElementById('logoutBtn');

    myLink.addEventListener('click', function(event) {
        event.preventDefault();

        localStorage.clear();
        for (let key in localStorage) {
            if (localStorage.hasOwnProperty(key)) {
                localStorage.removeItem(key);
            }
        }
        window.location.href = '/landing';

    });
</script>

<form class="new-fundriser-page" id="newFundriserForm" action="/add-fundraiser" method="post" >
    <!-- {/* step 1 */} -->

    <div class="new-fundriser-card" id="InputCard1" >
        <h3>New Fundraiser Details</h3>
        <div class="progress">
            <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 50%;" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
        </div>

        <div class="new-fundriser-form">

            <input type="hidden" id="formInputApplicantId" name="applicantId" >

            <div class="form-floating mb-3">
                <select class="form-select form-select-md mb-3" id='new-fund-type-select' aria-label=".form-select-lg example"  name="fundriserPurpose" >
                    <option selected>Choose the need for the fundraiser</option>
                    <option value="Personal Education">Personal Education</option>
                    <option value="Personal Health">Personal Health</option>
                    <option value="Orphanages/OldAgeHomes">Orphanages/OldAgeHomes</option>
                    <option value="Disaster Relief">Disaster Relief</option>
                </select>
                <label for="new-fund-type-select">Need for Fundraiser</label>
            </div>

            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="new-fund-applicant-name" placeholder="Name"  name="applicantName" />
                <label for="new-fund-applicant-name">Applicant Name</label>
            </div>

            <div class="form-floating mb-3">
                <input type="email" class="form-control" id="new-fund-applicant-email" placeholder="Email"  name="applicantEmail" />
                <label for="new-fund-applicant-email">Applicant Email</label>
            </div>

            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="new-fund-applicant-mobile" placeholder="mobile" name="applicantMobile" />
                <label for="new-fund-applicant-mobile">Applicant Mobile number</label>
            </div>

            <span class='new-fundriser-btns' >
              <button class='new-fundriser-blueBtn'  > <a href="/" >Home</a></button>
              <button class='new-fundriser-orangeBtn' type="button" onclick="displayCard2()" >Next</button>
            </span>

        </div>

    </div>




    <!-- {/* step 2 */} -->

    <div class="new-fundriser-card" id="InputCard2"  >
        <h3>New Fundraiser Details</h3>
        <div class="progress">
            <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 100%;" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
        </div>

        <div class="new-fundriser-form">

            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="new-fund-title" placeholder="Name"  name="title" />
                <label for="new-fund-title">Fundriser title</label>
            </div>

            <span class='new-fund-span-2'>

                <div class="form-floating mb-3">
                  <input type="number" class="form-control" id="new-fund-required-amount" placeholder="Name"  name="targetAmount" />
                  <label for="new-fund-applicant-name">Required amount</label>
                </div>

                <div class="form-floating mb-3">
                  <input type="date" class="form-control" id="new-fund-deadline" placeholder="Name"  name="deadline" />
                  <label for="new-fund-applicant-name">Deadline</label>
                </div>

            </span>

            <div class="form-floating mb-3">
                <textarea class="form-control" id="new-fund-description" rows="5" placeholder='description'  name="description" ></textarea>
                <label for="new-fund-description">Description</label>
            </div>

            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="new-fund-banner-img" placeholder="mobile"  name="bannerImage" />
                <label for="new-fund-applicant-mobile">Add Banner Image url</label>
            </div>

            <span class='new-fund-span-3'>

                <div class="form-floating mb-3">
                  <input type="text" class="form-control" id="new-fund-img1" placeholder="mobile"  name="extraImg1" />
                  <label for="new-fund-applicant-mobile">Add Image url</label>
                </div>

                <div class="form-floating mb-3">
                  <input type="text" class="form-control" id="new-fund-img2" placeholder="mobile" name="extraImg2"/>
                  <label for="new-fund-applicant-mobile">Add Image url</label>
                </div>

                <div class="form-floating mb-3">
                  <input type="text" class="form-control" id="new-fund-img3" placeholder="mobile" name="extraImg3"/>
                  <label for="new-fund-applicant-mobile">Add Image url</label>
                </div>
            </span>

            <span class='new-fundriser-btns' >
              <button class='new-fundriser-blueBtn' type="button" onclick="displayCard1()" >  Back</button>
              <button class='new-fundriser-orangeBtn' type="submit"  >Finish  </button>
            </span>

        </div>

    </div>

</form>


<script>

    document.getElementById("InputCard2").style.display = "none";

    function displayCard2(){
        document.getElementById("InputCard1").style.display = "none";
        document.getElementById("InputCard2").style.display = "block";
    }

    function displayCard1(){
        document.getElementById("InputCard1").style.display = "block";
        document.getElementById("InputCard2").style.display = "none";
    }


</script>

<script>
    document.getElementById('newFundriserForm').addEventListener('submit', function (e) {
        e.preventDefault();


        const formData = new FormData(this);


        fetch('/add-fundraiser', {
            method: 'POST',
            body: formData,
        })
            .then(response => {
                if (response.ok) {


                    var data = response.json();

                    return data;
                } else {
                    console.error('process failed');
                }
            })
            .then(fundriser => {
                alert("fundriser added!!");


                window.location.href = `/`

            })
            .catch(error => {
                console.error('Error:', error);
            });
    });
</script>


<script>

    function fetchData() {

        var localStorageData = localStorage.getItem('userData');
        var userData = JSON.parse(localStorageData);


        const formInputApplicantId = document.getElementById('formInputApplicantId');

        const navUserId = document.getElementById('navMyApplication');

        formInputApplicantId.value= userData._id;

        navUserId.href= `/my-fundrisers/${userData._id}`;

    }
    fetchData();

</script>



<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>


</body>
</html>